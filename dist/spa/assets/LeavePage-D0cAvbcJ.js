import{b as H,r as x,O as Pe,_ as A,$ as c,a0 as i,a2 as a,a9 as D,ab as w,a4 as s,a7 as v,a3 as S,ac as De,an as Se,aa as y,a1 as h,af as K,ad as ae,ae as ne,ao as xe,as as we,ak as Z,ar as ie,a5 as V,a8 as fe,ah as ge,aq as j,T as qe,ap as Me,j as ye,w as Ue,Y as Re,n as Te,a6 as ce,am as Fe,ag as Ne}from"./index-DUj6Qat5.js";import{Q as ze,a as ve}from"./QInnerLoading-BjTJWTbo.js";import{a as Qe,b as je}from"./QResizeObserver-DvN4Q8-d.js";import{Q as pe,a as Oe}from"./QFooter-B2YPwZ7w.js";import{T as N}from"./sweetalert-CVlrw-cm.js";import{h as _e,Q as me}from"./moment-BVHJYo2c.js";import{u as he}from"./leave-store-BNyfD5__.js";import{Q as $e}from"./QDate-Dbu_svyZ.js";import{Q as ke,C as Be}from"./ClosePopup-B7_6mH7x.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./format-CoaQEihs.js";const He={class:"text-h6 text-uppercase"},We={key:0},Ge={class:"q-mb-md"},Ke={class:"card-grid"},Je={class:"inner-card-anim-wrapper",style:{animationDelay:"100ms"}},Xe={class:"text-caption text-dark text-uppercase"},Ze={class:"absolute-left"},et={key:1},tt={class:"q-mb-md"},at={class:"card-grid"},st={class:"inner-card-anim-wrapper",style:{animationDelay:"100ms"}},lt={class:"text-caption text-dark text-uppercase"},ot={class:"absolute-left"},it={key:2},nt={class:"row q-col-gutter-xs q-mb-md"},rt={class:"col-5"},dt={class:"row q-col-gutter-xs q-mb-md"},ut={class:"col-2"},ct={class:"col-2"},pt={class:"col-1"},vt={class:"row q-gutter-sm"},mt={class:"text-caption text-uppercase text-grey"},Ve=3,xt={__name:"LeaveDialog",props:{modelValue:String,dialogName:String},emits:["update:modelValue","saved"],setup(re,{emit:se}){const L=he(),P=re,T=se,z=H({get:()=>P.modelValue===P.dialogName,set:n=>{n||T("update:modelValue",null)}}),W=x(!1),$=()=>{q(),M(),U(),Y.value=0},O=x(""),b=x(""),f=x(""),C=x(new Date().toISOString().split("T")[0]),k=x(new Date().toISOString().split("T")[0]),E=H(()=>{if(!C.value||!k.value)return"";const n=_e(C.value,"YYYY-MM-DD"),u=_e(k.value,"YYYY-MM-DD").diff(n,"days")+1;return u>0?u:0}),_=x(""),le=x(!1),p=Pe({employeeid:{type:null,message:""},typeid:{type:null,message:""},datestart:{type:null,message:""},dateend:{type:null,message:""},reason:{type:null,message:""}}),J=()=>N.fire({icon:"error",html:`
        <div class="text-h6 text-bold text-uppercase">Request Failed</div>
        <div class="text-caption">Something went wrong.</div>
        `}),ee=(n,r="required")=>(p[n].type=!0,p[n].msg=r,!0),G=n=>(p[n].type=null,p[n].msg="",!1),F=(n,r)=>r?G(n):ee(n,"required"),B=(n,r,u,X="invalid")=>r&&u&&new Date(r)<new Date(u)?ee(n,X):G(n),Q=()=>{let n=!1;return n||=F("employeeid",b.value),n&&J(),!n},te=()=>{let n=!1;return n||=F("typeid",f.value),n&&J(),!n},m=()=>{let n=!1;return n||=F("datestart",C.value),n||=F("dateend",k.value),n||=B("dateend",k.value,C.value),n||=F("reason",_.value),n&&J(),!n},l=async()=>{if(!(m&&!m())){W.value=!0;try{const n=O.value&&isEdit?await j.post(`/leave/${O.value}/update`,{employeeid:b.value,typeid:f.value,datestart:C.value,dateend:k.value,reason:_.value}):await j.post("/socket/leave/create",{employeeid:b.value,typeid:f.value,datestart:C.value,dateend:k.value,reason:_.value});T("saved"),T("update:modelValue",null),N.fire({icon:"success",html:`
                <div class="text-h6 text-bold text-uppercase">granted!</div>
                <div class="text-caption text-capitalize;">${n.data.message}<div>
            `})}catch(n){n.response&&n.response.data&&(t(n.response.data),N.fire({icon:"error",html:`
                    <div class="text-h6 text-bold text-uppercase">Request Failed</div>
                    <div class="text-caption">Something went wrong.</div>
                `}))}finally{W.value=!1}}},t=n=>{const r=Array.isArray(n)?n:n?.errors||[];Object.keys(p).forEach(u=>{p[u].type=null,p[u].messages=[]}),r.forEach(u=>{p[u.path]!==void 0&&(p[u.path].type=!0,p[u.path].messages.push(u.msg))})},o=n=>{if(!n)return"";const r=n.first_name||"",u=n.middle_name?n.middle_name.charAt(0).toUpperCase()+".":"",X=n.last_name||"",oe=n.suffix?` ${n.suffix}`:"";return`${r} ${u} ${X}${oe}`.trim()},d=x([]),g=x([]),q=async()=>{try{const{data:n}=await j.get("/leave/option/employee");d.value=n}catch(n){console.error("Error fetching options:",n)}},M=async()=>{try{const{data:n}=await j.get("/leave/option/leavetype");g.value=n}catch(n){console.error("Error fetching options:",n)}},U=()=>{O.value="",b.value="",f.value="",C.value=new Date().toISOString().split("T")[0],k.value=new Date().toISOString().split("T")[0],_.value="",le.value=!1,R()},R=()=>{Object.keys(p).forEach(n=>{p[n].type=null,p[n].msg=""})},I=x(""),be=H(()=>{const n=I.value.trim().toLowerCase();return n?d.value.filter(r=>String(r.label||"").toLowerCase().includes(n)):d.value}),de=H(()=>be.value),Ce=H(()=>de.value.length),Le=H(()=>be.value.length),Y=x(0),Ee=[Q,te],Ye=()=>{const n=Ee[Y.value];n&&!n()||Y.value++},Ae=()=>{Y.value>0&&Y.value--},ue=x(null);return(n,r)=>(c(),A(ge,{modelValue:z.value,"onUpdate:modelValue":r[14]||(r[14]=u=>z.value=u),"full-height":"",position:"right",persistent:"",square:"",class:"dialog",onBeforeShow:r[15]||(r[15]=u=>$())},{default:i(()=>[a(D,{class:"dialog-card column full-height"},{default:i(()=>[a(w,{class:"q-pa-lg"},{default:i(()=>[s("div",He,v(S(L).isEdit?"modify leave application":"create new leave application"),1)]),_:1}),a(De,{inset:""}),a(w,{class:"col q-pa-lg scroll"},{default:i(()=>[a(Se,{name:"fade-slide",mode:"out-in"},{default:i(()=>[(c(),y("div",{key:Y.value},[Y.value===0?(c(),y("div",We,[r[17]||(r[17]=s("div",{class:"text-overline text-uppercase text-bold q-mb-md"},"personnel",-1)),s("div",Ge,[s("div",{class:K(["text-caption text-uppercase q-mb-sm",p.employeeid.type?"text-negative text-italic":"text-grey"])},v(p.employeeid.type?p.employeeid.msg:"employee"),3),s("div",Ke,[s("div",Je,[de.value.length?h("",!0):(c(),A(D,{key:0,class:"card card-menu card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm"},{default:i(()=>[a(w,null,{default:i(()=>r[16]||(r[16]=[s("div",{class:"text-caption text-dark text-uppercase"},"no record found",-1)])),_:1,__:[16]})]),_:1}))]),de.value.length?(c(!0),y(ae,{key:0},ne(de.value,(u,X)=>(c(),y("div",{key:`data-${u.id}`,class:"inner-card-anim-wrapper",style:xe({animationDelay:`${X*100}ms`})},[a(D,{onClick:()=>{b.value=u.id},class:K(["card card-menu card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm",{"card--active":b.value===u.id}])},{default:i(()=>[a(w,null,{default:i(()=>[s("div",Xe,v(o(u)),1)]),_:2},1024),s("div",Ze,[a(we,{modelValue:b.value,"onUpdate:modelValue":r[0]||(r[0]=oe=>b.value=oe),val:u.id,"checked-icon":"bi-check-circle-fill","unchecked-icon":"bi-check-circle",size:"xs"},null,8,["modelValue","val"])])]),_:2},1032,["onClick","class"])],4))),128)):h("",!0)])])])):h("",!0),Y.value===1?(c(),y("div",et,[r[19]||(r[19]=s("div",{class:"text-overline text-uppercase text-bold q-mb-md"},"leave type",-1)),s("div",tt,[s("div",{class:K(["text-caption text-uppercase q-mb-sm",p.typeid.type?"text-negative text-italic":"text-grey"])},v(p.typeid.type?p.typeid.msg:"leave type"),3),s("div",at,[s("div",st,[g.value.length?h("",!0):(c(),A(D,{key:0,class:"card card-menu card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm"},{default:i(()=>[a(w,null,{default:i(()=>r[18]||(r[18]=[s("div",{class:"text-caption text-dark text-uppercase"},"no record found",-1)])),_:1,__:[18]})]),_:1}))]),g.value.length?(c(!0),y(ae,{key:0},ne(g.value,(u,X)=>(c(),y("div",{key:`data-${u.id}`,class:"inner-card-anim-wrapper",style:xe({animationDelay:`${X*100}ms`})},[a(D,{onClick:()=>{f.value=u.id},class:K(["card card-menu card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm",{"card--active":f.value===u.id}])},{default:i(()=>[a(w,null,{default:i(()=>[s("div",lt,v(u.name),1)]),_:2},1024),s("div",ot,[a(we,{modelValue:f.value,"onUpdate:modelValue":r[1]||(r[1]=oe=>f.value=oe),val:u.id,"checked-icon":"bi-check-circle-fill","unchecked-icon":"bi-check-circle",size:"xs"},null,8,["modelValue","val"])])]),_:2},1032,["onClick","class"])],4))),128)):h("",!0)])])])):h("",!0),Y.value===2?(c(),y("div",it,[r[21]||(r[21]=s("div",{class:"text-overline text-uppercase text-bold q-mb-md"},"reason & date",-1)),s("div",nt,[s("div",rt,[s("div",{class:K(["text-caption text-uppercase",p.reason.type?"text-negative text-italic":"text-grey"])},v(p.reason.type?p.reason.msg:"reason"),3),a(Z,{modelValue:_.value,"onUpdate:modelValue":r[2]||(r[2]=u=>_.value=u),outlined:"",type:"textarea",error:p.reason.type,"no-error-icon":!0,label:"Enter Reason"},null,8,["modelValue","error"])])]),s("div",dt,[s("div",ut,[s("div",{class:K(["text-caption text-uppercase",p.datestart.type?"text-negative text-italic":"text-grey"])},v(p.datestart.type?p.datestart.msg:"date start"),3),a(Z,{outlined:"",modelValue:C.value,"onUpdate:modelValue":r[5]||(r[5]=u=>C.value=u),label:"Enter Date",error:p.datestart.type,"no-error-icon":""},{default:i(()=>[a(ke,{cover:"","transition-show":"scale","transition-hide":"scale",class:"no-shadow custom-border radius-sm",ref_key:"popup",ref:ue},{default:i(()=>[a($e,{modelValue:C.value,"onUpdate:modelValue":[r[3]||(r[3]=u=>C.value=u),r[4]||(r[4]=()=>{ue.value.hide()})],mask:"YYYY-MM-DD"},null,8,["modelValue"])]),_:1},512)]),_:1},8,["modelValue","error"])]),s("div",ct,[s("div",{class:K(["text-caption text-uppercase",p.dateend.type?"text-negative text-italic":"text-grey"])},v(p.dateend.type?p.dateend.msg:"date end"),3),a(Z,{outlined:"",modelValue:k.value,"onUpdate:modelValue":r[8]||(r[8]=u=>k.value=u),label:"Enter Date",error:p.dateend.type,"no-error-icon":""},{default:i(()=>[a(ke,{cover:"","transition-show":"scale","transition-hide":"scale",class:"no-shadow custom-border radius-sm",ref_key:"popup",ref:ue},{default:i(()=>[a($e,{modelValue:k.value,"onUpdate:modelValue":[r[6]||(r[6]=u=>k.value=u),r[7]||(r[7]=()=>{ue.value.hide()})],mask:"YYYY-MM-DD"},null,8,["modelValue"])]),_:1},512)]),_:1},8,["modelValue","error"])]),s("div",pt,[r[20]||(r[20]=s("div",{class:"text-caption text-uppercase text-grey"},"day/s",-1)),a(Z,{modelValue:E.value,"onUpdate:modelValue":r[9]||(r[9]=u=>E.value=u),outlined:"","no-error-icon":!0,readonly:!0},null,8,["modelValue"])])])])):h("",!0)]))]),_:1})]),_:1}),a(ie,{class:"q-pa-lg bg"},{default:i(()=>[s("div",vt,[Y.value>0?(c(),A(V,{key:0,unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"previous",onClick:r[10]||(r[10]=()=>{Ae()})})):h("",!0),Y.value<Ve-1?(c(),A(V,{key:1,unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"next",onClick:r[11]||(r[11]=()=>{Ye()})})):h("",!0),Y.value===Ve-1?(c(),A(V,{key:2,unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"save",onClick:l})):h("",!0),a(V,{unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"discard",onClick:r[12]||(r[12]=()=>{T("update:modelValue",null)}),outline:""}),Y.value===0?(c(),A(Z,{key:3,outlined:"",dense:"",debounce:"1000",modelValue:I.value,"onUpdate:modelValue":r[13]||(r[13]=u=>I.value=u),placeholder:"Search..."},{prepend:i(()=>[a(fe,{name:"bi-search",style:{"font-size":"1rem"}})]),after:i(()=>[s("div",mt,v(Ce.value)+" of "+v(Le.value),1)]),_:1},8,["modelValue"])):h("",!0)])]),_:1}),a(ze,{showing:W.value},{default:i(()=>[a(D,{class:"no-shadow radius-md q-pa-md"},{default:i(()=>[a(w,{class:"text-center"},{default:i(()=>[s("div",null,[a(ve,{color:"dark"})]),r[22]||(r[22]=s("div",{class:"text-dark text-uppercase text-caption"},"we're working on it!",-1))]),_:1,__:[22]})]),_:1})]),_:1},8,["showing"])]),_:1})]),_:1},8,["modelValue"]))}},ft=Ie(xt,[["__scopeId","data-v-8876b1d7"]]),gt={class:"q-mb-md"},yt={class:"text-body1 text-uppercase"},_t={class:"q-mb-md"},ht={class:"text-body1 text-uppercase"},bt={class:"q-mb-md"},wt={class:"text-body1 text-uppercase"},$t={class:"q-mb-md"},kt={class:"text-body1 text-uppercase"},Vt={class:"q-mb-md"},Dt={class:"text-body1 text-uppercase"},St={class:"row q-col-gutter-xl q-mb-md q-mt-xl"},qt={class:"text-caption text-uppercase text-grey"},zt={key:0},Ct={class:"text-h6 text-uppercase"},Lt={class:"text-body1 text-uppercase text-italic"},Et={key:1},Yt={key:0},At={class:"text-grey q-mb-lg"},Pt={class:"text-h6 text-uppercase"},Mt={class:"text-body1 text-uppercase text-italic"},Ut=["src"],Rt={class:"text-h6 text-uppercase"},Tt={class:"text-body1 text-uppercase text-italic"},Ft={class:"text-caption text-uppercase text-italic"},Nt={key:1},Qt=["src"],jt={class:"text-h6 text-uppercase"},Ot={class:"text-body1 text-uppercase text-italic"},Bt={class:"text-caption text-uppercase text-italic"},It={key:2,class:"q-mt-md"},Ht={class:"q-gutter-sm"},Wt={class:"iframe-container"},Gt=["src"],Kt={__name:"LeaveInfoDialog",props:{modelValue:String,dialogName:String},emits:["update:modelValue","saved"],setup(re,{emit:se}){const L=he(),P=qe(),T=re,z=se,W=H({get:()=>T.modelValue===T.dialogName,set:l=>{l||z("update:modelValue",null)}}),$=x(!1),O=()=>{le(L.data?.id)},b=l=>{const t=Array.isArray(l)?l:l?.errors||[];Object.keys(Errors).forEach(o=>{Errors[o].type=null,Errors[o].messages=[]}),t.forEach(o=>{Errors[o.path]!==void 0&&(Errors[o.path].type=!0,Errors[o.path].messages.push(o.msg))})},f=l=>l?_e(l).format("MMMM Do, YYYY hh:mm A"):"",C=l=>{if(!l)return"";const t=l.first_name||"",o=l.middle_name?l.middle_name.charAt(0).toUpperCase()+".":"",d=l.last_name||"",g=l.suffix?` ${l.suffix}`:"";return`${t} ${o} ${d}${g}`.trim()},k=(l,t,o="en-US")=>{if(!l)return"";const d=new Date(l),g=new Date(t||l),q=d.getFullYear()===g.getFullYear()&&d.getMonth()===g.getMonth()&&d.getDate()===g.getDate(),M=I=>I.toLocaleString(o,{month:"long"}),U=I=>I.getDate(),R=I=>I.getFullYear();return q?`${M(d)} ${U(d)}, ${R(d)}`:d.getMonth()===g.getMonth()&&d.getFullYear()===g.getFullYear()?`${M(d)} ${U(d)}-${U(g)}, ${R(d)}`:`${M(d)} ${U(d)}, ${R(d)} - ${M(g)} ${U(g)}, ${R(g)}`},E=(l,t)=>{if(!l)return 0;const o=new Date(l),d=new Date(t||l);o.setHours(0,0,0,0),d.setHours(0,0,0,0);const g=Math.round((d-o)/(1e3*60*60*24));return g>=0?g+1:0},_=x(null),le=async l=>{$.value=!0;try{const t=await j.get(`/leave/${l}`);_.value=t.data.result}catch(t){console.error("Error fetching all data:",t),N.fire({icon:"error",html:`
                <div class="text-h6 text-bold text-uppercase">Error</div>
                <div class="text-caption text-capitalize;">Unable to fetch records</div>
            `})}finally{$.value=!1}},p=H(()=>{if(!_.value?.approvals||_.value.approvals.length===0)return!1;const t=[..._.value.approvals].sort((o,d)=>o.order-d.order).find(o=>o.status==="Pending");return t?t.approver_id===P.user?.id:!1}),J=async l=>{$.value=!0;const t=Number(P.user.id),g=_.value.approvals.find(q=>Number(q?.approver_id)===Number(t))?.id??null;try{const q=await j.post(`/socket/leave/${l}/approve`,{approvalid:g});z("saved"),z("update:modelValue",null),N.fire({icon:"success",html:`
                <div class="text-h6 text-bold text-uppercase">granted!</div>
                <div class="text-caption text-capitalize;">${q.data.message}<div>
            `})}catch(q){q.response&&q.response.data&&(b(q.response.data),N.fire({icon:"error",html:`
                    <div class="text-h6 text-bold text-uppercase">Request Failed</div>
                    <div class="text-caption">Something went wrong.</div>
                `}))}finally{$.value=!1}},ee=async l=>{$.value=!0;try{const t=await j.post(`/socket/leave/${l}/cancel`);z("saved"),z("update:modelValue",null),N.fire({icon:"success",html:`
                <div class="text-h6 text-bold text-uppercase">granted!</div>
                <div class="text-caption text-capitalize;">${t.data.message}<div>
            `})}catch(t){t.response&&t.response.data&&(b(t.response.data),N.fire({icon:"error",html:`
                    <div class="text-h6 text-bold text-uppercase">Request Failed</div>
                    <div class="text-caption">Something went wrong.</div>
                `}))}finally{$.value=!1}},G=x(!1),F=x(null),B=async l=>{$.value=!0;try{const t=await j.get(`/leave/${l}/pdf`,{responseType:"arraybuffer"}),o=new Blob([t.data],{type:"application/pdf"}),d=window.URL.createObjectURL(o)+"#view=FitW";F.value=d,G.value=!0}catch(t){console.error("Error generating PDF:",t)}finally{$.value=!1}},Q=x([]),te=H(()=>Array.isArray(Q.value)&&Q.value.some(l=>String(l).trim()!=="")),m=async l=>{$.value=!0;try{const t=await j.post(`/socket/leave/${l}/overide`,{signatories:Q.value});N.fire({icon:"success",html:`
                <div class="text-h6 text-bold text-uppercase">granted!</div>
                <div class="text-caption text-capitalize;">${t.data.message}<div>
            `}),z("saved"),z("update:modelValue",null)}catch{e.response&&e.response.data&&(b(e.response.data),N.fire({icon:"error",html:`
                    <div class="text-h6 text-bold text-uppercase">Request Failed</div>
                    <div class="text-caption">Something went wrong.</div>
                `}))}finally{$.value=!1}};return(l,t)=>(c(),y(ae,null,[a(ge,{modelValue:W.value,"onUpdate:modelValue":t[6]||(t[6]=o=>W.value=o),"full-height":"",position:"right",persistent:"",square:"",class:"dialog",onBeforeShow:t[7]||(t[7]=o=>O())},{default:i(()=>[a(D,{class:"dialog-card column full-height"},{default:i(()=>[a(w,{class:"q-pa-lg"},{default:i(()=>t[9]||(t[9]=[s("div",{class:"text-h6 text-uppercase"},"leave application",-1)])),_:1,__:[9]}),a(De,{inset:""}),a(w,{class:"col q-pa-lg scroll"},{default:i(()=>[s("div",gt,[t[10]||(t[10]=s("div",{class:"text-caption text-uppercase text-grey"},"employee",-1)),s("div",yt,v(C(_.value?.employee)),1)]),s("div",_t,[t[11]||(t[11]=s("div",{class:"text-caption text-uppercase text-grey"},"leave type",-1)),s("div",ht,v(_.value?.leaveType?.name),1)]),s("div",bt,[t[12]||(t[12]=s("div",{class:"text-caption text-uppercase text-grey"},"leave duration",-1)),s("div",wt,v(k(_.value?.date_from,_.value?.date_to)),1)]),s("div",$t,[t[13]||(t[13]=s("div",{class:"text-caption text-uppercase text-grey"},"no of day",-1)),s("div",kt,v(E(_.value?.date_from,_.value?.date_to)),1)]),s("div",Vt,[t[14]||(t[14]=s("div",{class:"text-caption text-uppercase text-grey"},"status",-1)),s("div",Dt,v(_.value?.status),1)]),s("div",St,[(c(!0),y(ae,null,ne(_.value?.approvals,(o,d)=>(c(),y("div",null,[s("div",qt,v(o?.status=="Pending"?"unsigned":o?.setting?.description),1),o?.status=="Pending"?(c(),y("div",zt,[s("div",Ct,v(o?.original_approver_name),1),s("div",Lt,v(o?.original_approver_position),1)])):h("",!0),o?.status=="Approved"?(c(),y("div",Et,[o?.is_overide?(c(),y("div",Yt,[s("div",At,[s("div",Pt,v(o?.original_approver_name),1),s("div",Mt,v(o?.original_approver_position),1)]),t[15]||(t[15]=s("div",{class:"text-caption text-uppercase text-italic text-bold q-mb-lg"},"overiden by",-1)),s("img",{src:o?.override_signature,width:"150"},null,8,Ut),s("div",Rt,v(o?.override_name),1),s("div",Tt,v(o?.override_position),1),s("div",Ft,v(f(o?.signed_at)),1)])):h("",!0),o?.is_overide?h("",!0):(c(),y("div",Nt,[s("img",{src:o?.original_signature,width:"150"},null,8,Qt),s("div",jt,v(o?.original_approver_name),1),s("div",Ot,v(o?.original_approver_position),1),s("div",Bt,v(f(o?.signed_at)),1)]))])):h("",!0),o?.status=="Pending"&&S(P).hasRole(["SuperAdmin","Management"])&&S(L).data?.status!=="Cancelled"?(c(),y("div",It,[a(Me,{modelValue:Q.value,"onUpdate:modelValue":t[0]||(t[0]=g=>Q.value=g),val:o?.id,label:"Overide","checked-icon":"bi-check-circle-fill","unchecked-icon":"bi-check-circle",size:"sm",class:"tex-caption"},null,8,["modelValue","val"])])):h("",!0)]))),256))])]),_:1}),a(ie,{class:"q-pa-lg bg"},{default:i(()=>[s("div",Ht,[p.value&&S(P).hasRole(["SuperAdmin","Admin","Management","HR"])?(c(),A(V,{key:0,unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"approve"},{default:i(()=>[a(me,{onBeforeShow:()=>{},"transition-show":"jump-up","transition-hide":"jump-down",offset:[0,15],class:"radius-sm",style:{"box-shadow":"rgba(0, 0, 0, 0.09) 0px 3px 12px"}},{default:i(()=>[a(D,{class:"no-shadow radius-sm q-pa-lg",style:{width:"300px"}},{default:i(()=>[a(w,null,{default:i(()=>t[16]||(t[16]=[s("div",{class:"text-h6 text-center text-uppercase"}," proceed to approve ",-1)])),_:1,__:[16]}),a(ie,null,{default:i(()=>[a(V,{unelevated:"",size:"md",color:"primary",class:"full-width text-capitalize",label:"proceed",onClick:t[1]||(t[1]=o=>J(S(L).data?.id))})]),_:1})]),_:1})]),_:1})]),_:1})):h("",!0),S(L).data?.status=="Filed"&&S(P).hasRole(["SuperAdmin","Management"])?(c(),A(V,{key:1,disable:!te.value,unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"overide"},{default:i(()=>[a(me,{onBeforeShow:()=>{},"transition-show":"jump-up","transition-hide":"jump-down",offset:[0,15],class:"radius-sm",style:{"box-shadow":"rgba(0, 0, 0, 0.09) 0px 3px 12px"}},{default:i(()=>[a(D,{class:"no-shadow radius-sm q-pa-lg",style:{width:"300px"}},{default:i(()=>[a(w,null,{default:i(()=>t[17]||(t[17]=[s("div",{class:"text-h6 text-center text-uppercase"}," proceed to overide signature ",-1)])),_:1,__:[17]}),a(ie,null,{default:i(()=>[a(V,{unelevated:"",size:"md",color:"primary",class:"full-width text-capitalize",label:"proceed",onClick:t[2]||(t[2]=o=>m(S(L).data?.id))})]),_:1})]),_:1})]),_:1})]),_:1},8,["disable"])):h("",!0),S(L).data?.status!=="Cancelled"&&S(P).hasRole(["SuperAdmin","Admin","Management","HR"])?(c(),A(V,{key:2,unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"cancel"},{default:i(()=>[a(me,{"transition-show":"jump-up","transition-hide":"jump-down",offset:[0,15],class:"radius-sm",style:{"box-shadow":"rgba(0, 0, 0, 0.09) 0px 3px 12px"}},{default:i(()=>[a(D,{class:"no-shadow radius-sm q-pa-lg",style:{width:"300px"}},{default:i(()=>[a(w,null,{default:i(()=>t[18]||(t[18]=[s("div",{class:"text-h6 text-center text-uppercase"}," proceed to cancel ",-1)])),_:1,__:[18]}),a(ie,null,{default:i(()=>[a(V,{unelevated:"",size:"md",color:"primary",class:"full-width text-capitalize",label:"proceed",onClick:t[3]||(t[3]=o=>ee(S(L).data?.id))})]),_:1})]),_:1})]),_:1})]),_:1})):h("",!0),S(L).data?.status!=="Cancelled"?(c(),A(V,{key:3,unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"print",onClick:t[4]||(t[4]=o=>B(S(L).data?.id))})):h("",!0),a(V,{unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"discard",onClick:t[5]||(t[5]=()=>{z("update:modelValue",null)}),outline:""})])]),_:1}),a(ze,{showing:$.value},{default:i(()=>[a(D,{class:"no-shadow radius-md q-pa-md"},{default:i(()=>[a(w,{class:"text-center"},{default:i(()=>[s("div",null,[a(ve,{color:"dark"})]),t[19]||(t[19]=s("div",{class:"text-dark text-uppercase text-caption"},"we're working on it!",-1))]),_:1,__:[19]})]),_:1})]),_:1},8,["showing"])]),_:1})]),_:1},8,["modelValue"]),a(ge,{modelValue:G.value,"onUpdate:modelValue":t[8]||(t[8]=o=>G.value=o),"full-height":"","full-width":"",class:"pdf"},{default:i(()=>[a(D,{class:"bg-white q-pa-none",style:{height:"100vh",overflow:"hidden"}},{default:i(()=>[ye(a(V,{icon:"bi-x",class:"fixed bg-white text-primary shadow-2",round:"",dense:"",style:{top:"15px",right:"15px","z-index":"999"}},null,512),[[Be]]),a(w,{class:"q-pa-none",style:{height:"100%",overflow:"hidden"}},{default:i(()=>[s("div",Wt,[F.value?(c(),y("iframe",{key:0,src:F.value,frameborder:"0"},null,8,Gt)):h("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},Jt={class:"filter-inline"},Xt={class:"q-gutter-xs"},Zt={class:"card-grid"},ea={key:0,class:"card-anim-wrapper",style:{animationDelay:"120ms"}},ta={key:1,class:"card-anim-wrapper",style:{animationDelay:"120ms"}},aa={key:2,class:"card-anim-wrapper",style:{animationDelay:"120ms"}},sa={class:"text-subtitle2 text-uppercase"},la={class:"text-caption text-capitalize text-grey"},oa={class:"text-caption text-uppercase"},ia={class:"text-caption"},na={class:"text-caption text-grey"},ra={class:"text-caption text-uppercase"},da={id:"glass-overlay"},ba={__name:"LeavePage",setup(re){const se=qe(),L=he(),P=new Date,T=x(String(P.getMonth()+1).padStart(2,"0")),z=x(String(P.getFullYear())),W=Array.from({length:12},(m,l)=>{const t=new Date(0,l).toLocaleString("en-US",{month:"short"}),o=String(l+1).padStart(2,"0");return{label:t,value:o}}),$=x(!1),O=x([]),b=x({}),f=x(1),C=x(10),k=x(""),E=async()=>{$.value=!0;try{const{data:m}=await j.get("/leave",{params:{Page:f.value,Limit:C.value,Filter:k.value||"",month:T.value,year:z.value}});O.value=m.data,b.value=m.meta}catch(m){console.error("Error fetching all data:",m),N.fire({icon:"error",html:`
                <div class="text-h6 text-bold text-uppercase">Error</div>
                <div class="text-caption text-capitalize;">Unable to fetch records</div>
            `})}finally{$.value=!1}};Ue(k,()=>{f.value=1,E()});const _=()=>{f.value<b.value.TotalPages&&(f.value++,E())},le=()=>{f.value>1&&(f.value--,E())},p=()=>{f.value>1&&(f.value=1,E())},J=()=>{f.value<b.value.TotalPages&&(f.value=b.value.TotalPages,E())},ee=m=>{if(!m)return"";const l=m.first_name||"",t=m.middle_name?m.middle_name.charAt(0).toUpperCase()+".":"",o=m.last_name||"",d=m.suffix?` ${m.suffix}`:"";return`${l} ${t} ${o}${d}`.trim()},G=(m,l,t="en-US")=>{if(!m)return"";const o=new Date(m),d=new Date(l||m),g=o.getFullYear()===d.getFullYear()&&o.getMonth()===d.getMonth()&&o.getDate()===d.getDate(),q=R=>R.toLocaleString(t,{month:"long"}),M=R=>R.getDate(),U=R=>R.getFullYear();return g?`${q(o)} ${M(o)}, ${U(o)}`:o.getMonth()===d.getMonth()&&o.getFullYear()===d.getFullYear()?`${q(o)} ${M(o)}-${M(d)}, ${U(o)}`:`${q(o)} ${M(o)}, ${U(o)} - ${q(d)} ${M(d)}, ${U(d)}`},F=(m,l)=>{if(!m)return 0;const t=new Date(m),o=new Date(l||m);t.setHours(0,0,0,0),o.setHours(0,0,0,0);const d=Math.round((o-t)/(1e3*60*60*24));return d>=0?d+1:0};Re(()=>{E()});const B=x(null),Q=m=>{B.value=m},te=x(!0);return Te(()=>{setTimeout(()=>{te.value=!1},1e3)}),(m,l)=>(c(),y("div",null,[a(D,{class:"no-shadow radius-xs q-mb-md"},{default:i(()=>[a(w,null,{default:i(()=>[s("div",Jt,[a(Z,{outlined:"",modelValue:z.value,"onUpdate:modelValue":l[0]||(l[0]=t=>z.value=t),style:{width:"80px"},dense:""},null,8,["modelValue"]),s("div",Xt,[(c(!0),y(ae,null,ne(S(W),(t,o)=>(c(),A(V,{round:"",unelevated:"",class:K(T.value===t.value?"active":"inactive"),onClick:()=>{T.value=t.value,E()},size:"md",label:t.label},null,8,["class","onClick","label"]))),256))])])]),_:1})]),_:1}),s("div",Zt,[S(se).hasRole(["SuperAdmin","Admin","HR"])?(c(),y("div",ea,[ye((c(),A(D,{key:"data-add",class:"card card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm",onClick:l[1]||(l[1]=()=>{Q("LeaveDialog"),S(L).isEdit=!1})},{default:i(()=>[a(w,null,{default:i(()=>[a(fe,{name:"bi-plus-circle",color:"grey",size:"xl"})]),_:1})]),_:1})),[[Ne]])])):h("",!0),$.value?(c(),y("div",ta,[a(D,{key:"data-add",class:"card card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm"},{default:i(()=>[a(w,{class:"text-center"},{default:i(()=>[a(ve,{color:"dark"}),l[7]||(l[7]=s("div",{class:"text-caption text-grey text-uppercase q-mt-xs"},"we're working on it!",-1))]),_:1,__:[7]})]),_:1})])):!$.value&&O.value.length===0?(c(),y("div",aa,[a(D,{key:"data-add",class:"card card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm"},{default:i(()=>[a(w,{class:"text-center"},{default:i(()=>l[8]||(l[8]=[s("div",{class:"text-caption text-uppercase text-grey"},"no data found",-1)])),_:1,__:[8]})]),_:1})])):(c(!0),y(ae,{key:3},ne(O.value,(t,o)=>(c(),y("div",{key:`data-${t.id}`,class:"card-anim-wrapper",style:xe({animationDelay:`${o*120}ms`})},[a(D,{onClick:()=>{Q("LeaveInfoDialog"),S(L).data=t},class:"card card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm"},{default:i(()=>[a(w,null,{default:i(()=>[s("div",sa,v(ee(t?.employee)),1),s("div",la,v(t?.status),1)]),_:2},1024),a(w,null,{default:i(()=>[s("div",oa,v(t?.leaveType?.name),1),s("div",ia,v(G(t?.date_from,t?.date_to)),1),s("div",na,v(F(t?.date_from,t?.date_to))+" day/s",1)]),_:2},1024)]),_:2},1032,["onClick"])],4))),128))]),a(Oe,{class:"bg-white no-shadow q-mx-lg q-mb-md q-py-sm radius-xs text-grey"},{default:i(()=>[a(Qe,null,{default:i(()=>[a(je,{class:"text-caption text-uppercase"},{default:i(()=>l[9]||(l[9]=[s("div",null,"Â© 2025 WORKFORCE. All Rights Reserved.",-1)])),_:1,__:[9]}),a(Z,{outlined:"",dense:"",debounce:"1000",modelValue:k.value,"onUpdate:modelValue":l[2]||(l[2]=t=>k.value=t),placeholder:"Search..."},{before:i(()=>[s("div",ra,v(`page ${b.value.CurrentPage} of ${b.value.TotalPages}`),1)]),after:i(()=>[a(V,{unelevated:"",size:"sm",round:"",color:"primary",icon:"bi-arrow-bar-left",disable:f.value<=1,onClick:p},{default:i(()=>[a(pe,{anchor:"top middle",self:"top middle","transition-show":"scale","transition-hide":"scale",class:"text-capitalize"},{default:i(()=>l[10]||(l[10]=[ce("First Page")])),_:1,__:[10]})]),_:1},8,["disable"]),a(V,{unelevated:"",size:"sm",round:"",color:"primary",icon:"bi-arrow-left-short",disable:f.value<=1,onClick:le},{default:i(()=>[a(pe,{anchor:"top middle",self:"top middle","transition-show":"scale","transition-hide":"scale",class:"text-capitalize"},{default:i(()=>l[11]||(l[11]=[ce("Previous")])),_:1,__:[11]})]),_:1},8,["disable"]),a(V,{unelevated:"",size:"sm",round:"",color:"primary",icon:"bi-arrow-right-short",disable:f.value>=b.value.TotalPages,onClick:_},{default:i(()=>[a(pe,{anchor:"top middle",self:"top middle","transition-show":"scale","transition-hide":"scale",class:"text-capitalize"},{default:i(()=>l[12]||(l[12]=[ce("Next")])),_:1,__:[12]})]),_:1},8,["disable"]),a(V,{unelevated:"",size:"sm",round:"",color:"primary",icon:"bi-arrow-bar-right",disable:f.value>=b.value.TotalPages,onClick:J},{default:i(()=>[a(pe,{anchor:"top middle",self:"top middle","transition-show":"scale","transition-hide":"scale",class:"text-capitalize"},{default:i(()=>l[13]||(l[13]=[ce("Last Page")])),_:1,__:[13]})]),_:1},8,["disable"])]),prepend:i(()=>[a(fe,{name:"bi-search",style:{"font-size":"1rem"}})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(ft,{modelValue:B.value,"onUpdate:modelValue":l[3]||(l[3]=t=>B.value=t),"dialog-name":"LeaveDialog",onSaved:l[4]||(l[4]=()=>{E()})},null,8,["modelValue"]),a(Kt,{modelValue:B.value,"onUpdate:modelValue":l[5]||(l[5]=t=>B.value=t),"dialog-name":"LeaveInfoDialog",onSaved:l[6]||(l[6]=()=>{E()})},null,8,["modelValue"]),a(Se,{name:"glass-fade"},{default:i(()=>[ye(s("div",da,[a(D,{class:"no-shadow radius-md q-pa-md"},{default:i(()=>[a(w,{class:"text-center"},{default:i(()=>[s("div",null,[a(ve,{color:"dark"})]),l[14]||(l[14]=s("div",{class:"text-dark text-uppercase text-caption"},"we're working on it!",-1))]),_:1,__:[14]})]),_:1})],512),[[Fe,te.value]])]),_:1})]))}};export{ba as default};
