import{af as Pe,a as H,r as f,O as Me,V as M,W as c,X as l,Z as a,a4 as S,a6 as w,$ as s,a2 as m,_ as z,a7 as Se,ak as De,a5 as _,Y as h,aa as X,a8 as le,a9 as re,am as fe,ap as we,ag as ee,ai as ne,a0 as V,a3 as ge,ac as ye,aq as B,S as qe,ar as Ue,d as _e,w as Re,T as Te,k as Fe,a1 as pe,aj as Ne,ab as Qe}from"./index-Lf_p_M7O.js";import{a as $e,Q as ze,b as me}from"./QSpinnerIos-fP6uRLlR.js";import{a as je,b as Oe}from"./QResizeObserver-Bj2nox93.js";import{Q as ve,a as Be}from"./QFooter-Bq9OZnDZ.js";import{T as j}from"./sweetalert-_TNglJgc.js";import{_ as Ie,h as he,Q as xe}from"./_plugin-vue_export-helper-B4qR4-TP.js";import{Q as ke,C as He}from"./ClosePopup-9uufxfJk.js";import"./format-CoaQEihs.js";const be=Pe("leaveStore",{state:()=>({component:null,data:null,isEdit:!1}),getters:{},actions:{},persist:!0}),We={class:"text-h6 text-uppercase"},Ge={key:0},Ke={class:"q-mb-md"},Xe={class:"card-grid"},Ze={class:"inner-card-anim-wrapper",style:{animationDelay:"100ms"}},Je={class:"text-caption text-dark text-uppercase"},et={class:"absolute-left"},tt={key:1},at={class:"q-mb-md"},st={class:"card-grid"},lt={class:"inner-card-anim-wrapper",style:{animationDelay:"100ms"}},ot={class:"text-caption text-dark text-uppercase"},it={class:"absolute-left"},nt={key:2},rt={class:"row q-col-gutter-xs q-mb-md"},dt={class:"col-5"},ut={class:"row q-col-gutter-xs q-mb-md"},ct={class:"col-2"},pt={class:"col-2"},vt={class:"col-1"},mt={class:"row q-gutter-sm"},xt={class:"text-caption text-uppercase text-grey"},Ve=3,ft={__name:"LeaveDialog",props:{modelValue:String,dialogName:String},emits:["update:modelValue","saved"],setup(de,{emit:oe}){const E=be(),U=de,R=oe,C=H({get:()=>U.modelValue===U.dialogName,set:n=>{n||R("update:modelValue",null)}}),W=f(!1),$=()=>{y(),q(),Q(),P.value=0},I=f(""),b=f(""),g=f(""),L=f(new Date().toISOString().split("T")[0]),k=f(new Date().toISOString().split("T")[0]),Y=H(()=>{if(!L.value||!k.value)return"";const n=he(L.value,"YYYY-MM-DD"),d=he(k.value,"YYYY-MM-DD").diff(n,"days")+1;return d>0?d:0}),T=f(""),D=f(!1),p=Me({employeeid:{type:null,message:""},typeid:{type:null,message:""},datestart:{type:null,message:""},dateend:{type:null,message:""},reason:{type:null,message:""}}),Z=()=>j.fire({icon:"error",html:`
        <div class="text-h6 text-bold text-uppercase">Request Failed</div>
        <div class="text-caption">Something went wrong.</div>
        `}),te=(n,r="required")=>(p[n].type=!0,p[n].msg=r,!0),ae=n=>(p[n].type=null,p[n].msg="",!1),F=(n,r)=>r?ae(n):te(n,"required"),N=(n,r,d,J="invalid")=>r&&d&&new Date(r)<new Date(d)?te(n,J):ae(n),se=()=>{let n=!1;return n||=F("employeeid",b.value),n&&Z(),!n},O=()=>{let n=!1;return n||=F("typeid",g.value),n&&Z(),!n},x=()=>{let n=!1;return n||=F("datestart",L.value),n||=F("dateend",k.value),n||=N("dateend",k.value,L.value),n||=F("reason",T.value),n&&Z(),!n},u=async()=>{if(!(x&&!x())){W.value=!0;try{const n=I.value&&isEdit?await B.post(`/leave/${I.value}/update`,{employeeid:b.value,typeid:g.value,datestart:L.value,dateend:k.value,reason:T.value}):await B.post("/socket/leave/create",{employeeid:b.value,typeid:g.value,datestart:L.value,dateend:k.value,reason:T.value});R("saved"),R("update:modelValue",null),j.fire({icon:"success",html:`
                <div class="text-h6 text-bold text-uppercase">granted!</div>
                <div class="text-caption text-capitalize;">${n.data.message}<div>
            `})}catch(n){n.response&&n.response.data&&(o(n.response.data),j.fire({icon:"error",html:`
                    <div class="text-h6 text-bold text-uppercase">Request Failed</div>
                    <div class="text-caption">Something went wrong.</div>
                `}))}finally{W.value=!1}}},o=n=>{const r=Array.isArray(n)?n:n?.errors||[];Object.keys(p).forEach(d=>{p[d].type=null,p[d].messages=[]}),r.forEach(d=>{p[d.path]!==void 0&&(p[d.path].type=!0,p[d.path].messages.push(d.msg))})},t=n=>{if(!n)return"";const r=n.first_name||"",d=n.middle_name?n.middle_name.charAt(0).toUpperCase()+".":"",J=n.last_name||"",ie=n.suffix?` ${n.suffix}`:"";return`${r} ${d} ${J}${ie}`.trim()},i=f([]),v=f([]),y=async()=>{try{const{data:n}=await B.get("/leave/option/employee");i.value=n}catch(n){console.error("Error fetching options:",n)}},q=async()=>{try{const{data:n}=await B.get("/leave/option/leavetype");v.value=n}catch(n){console.error("Error fetching options:",n)}},Q=()=>{I.value="",b.value="",g.value="",L.value=new Date().toISOString().split("T")[0],k.value=new Date().toISOString().split("T")[0],T.value="",D.value=!1,A()},A=()=>{Object.keys(p).forEach(n=>{p[n].type=null,p[n].msg=""})},G=f(""),K=H(()=>{const n=G.value.trim().toLowerCase();return n?i.value.filter(r=>String(r.label||"").toLowerCase().includes(n)):i.value}),ue=H(()=>K.value),Ce=H(()=>ue.value.length),Le=H(()=>K.value.length),P=f(0),Ee=[se,O],Ye=()=>{const n=Ee[P.value];n&&!n()||P.value++},Ae=()=>{P.value>0&&P.value--},ce=f(null);return(n,r)=>(c(),M(ye,{modelValue:C.value,"onUpdate:modelValue":r[14]||(r[14]=d=>C.value=d),"full-height":"",position:"right",persistent:"",square:"",class:"dialog",onBeforeShow:r[15]||(r[15]=d=>$())},{default:l(()=>[a(S,{class:"dialog-card column full-height"},{default:l(()=>[a(w,{class:"q-pa-lg"},{default:l(()=>[s("div",We,m(z(E).isEdit?"modify leave application":"create new leave application"),1)]),_:1}),a(Se,{inset:""}),a(w,{class:"col q-pa-lg scroll"},{default:l(()=>[a(De,{name:"fade-slide",mode:"out-in"},{default:l(()=>[(c(),_("div",{key:P.value},[P.value===0?(c(),_("div",Ge,[r[17]||(r[17]=s("div",{class:"text-overline text-uppercase text-bold q-mb-md"},"personnel",-1)),s("div",Ke,[s("div",{class:X(["text-caption text-uppercase q-mb-sm",p.employeeid.type?"text-negative text-italic":"text-grey"])},m(p.employeeid.type?p.employeeid.msg:"employee"),3),s("div",Xe,[s("div",Ze,[ue.value.length?h("",!0):(c(),M(S,{key:0,class:"card card-menu card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm"},{default:l(()=>[a(w,null,{default:l(()=>r[16]||(r[16]=[s("div",{class:"text-caption text-dark text-uppercase"},"no record found",-1)])),_:1,__:[16]})]),_:1}))]),ue.value.length?(c(!0),_(le,{key:0},re(ue.value,(d,J)=>(c(),_("div",{key:`data-${d.id}`,class:"inner-card-anim-wrapper",style:fe({animationDelay:`${J*100}ms`})},[a(S,{onClick:()=>{b.value=d.id},class:X(["card card-menu card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm",{"card--active":b.value===d.id}])},{default:l(()=>[a(w,null,{default:l(()=>[s("div",Je,m(t(d)),1)]),_:2},1024),s("div",et,[a(we,{modelValue:b.value,"onUpdate:modelValue":r[0]||(r[0]=ie=>b.value=ie),val:d.id,"checked-icon":"bi-check-circle-fill","unchecked-icon":"bi-check-circle",size:"xs"},null,8,["modelValue","val"])])]),_:2},1032,["onClick","class"])],4))),128)):h("",!0)])])])):h("",!0),P.value===1?(c(),_("div",tt,[r[19]||(r[19]=s("div",{class:"text-overline text-uppercase text-bold q-mb-md"},"leave type",-1)),s("div",at,[s("div",{class:X(["text-caption text-uppercase q-mb-sm",p.typeid.type?"text-negative text-italic":"text-grey"])},m(p.typeid.type?p.typeid.msg:"leave type"),3),s("div",st,[s("div",lt,[v.value.length?h("",!0):(c(),M(S,{key:0,class:"card card-menu card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm"},{default:l(()=>[a(w,null,{default:l(()=>r[18]||(r[18]=[s("div",{class:"text-caption text-dark text-uppercase"},"no record found",-1)])),_:1,__:[18]})]),_:1}))]),v.value.length?(c(!0),_(le,{key:0},re(v.value,(d,J)=>(c(),_("div",{key:`data-${d.id}`,class:"inner-card-anim-wrapper",style:fe({animationDelay:`${J*100}ms`})},[a(S,{onClick:()=>{g.value=d.id},class:X(["card card-menu card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm",{"card--active":g.value===d.id}])},{default:l(()=>[a(w,null,{default:l(()=>[s("div",ot,m(d.name),1)]),_:2},1024),s("div",it,[a(we,{modelValue:g.value,"onUpdate:modelValue":r[1]||(r[1]=ie=>g.value=ie),val:d.id,"checked-icon":"bi-check-circle-fill","unchecked-icon":"bi-check-circle",size:"xs"},null,8,["modelValue","val"])])]),_:2},1032,["onClick","class"])],4))),128)):h("",!0)])])])):h("",!0),P.value===2?(c(),_("div",nt,[r[21]||(r[21]=s("div",{class:"text-overline text-uppercase text-bold q-mb-md"},"reason & date",-1)),s("div",rt,[s("div",dt,[s("div",{class:X(["text-caption text-uppercase",p.reason.type?"text-negative text-italic":"text-grey"])},m(p.reason.type?p.reason.msg:"reason"),3),a(ee,{modelValue:T.value,"onUpdate:modelValue":r[2]||(r[2]=d=>T.value=d),outlined:"",type:"textarea",error:p.reason.type,"no-error-icon":!0,label:"Enter Reason"},null,8,["modelValue","error"])])]),s("div",ut,[s("div",ct,[s("div",{class:X(["text-caption text-uppercase",p.datestart.type?"text-negative text-italic":"text-grey"])},m(p.datestart.type?p.datestart.msg:"date start"),3),a(ee,{outlined:"",modelValue:L.value,"onUpdate:modelValue":r[5]||(r[5]=d=>L.value=d),label:"Enter Date",error:p.datestart.type,"no-error-icon":""},{default:l(()=>[a(ke,{cover:"","transition-show":"scale","transition-hide":"scale",class:"no-shadow custom-border radius-sm",ref_key:"popup",ref:ce},{default:l(()=>[a($e,{modelValue:L.value,"onUpdate:modelValue":[r[3]||(r[3]=d=>L.value=d),r[4]||(r[4]=()=>{ce.value.hide()})],mask:"YYYY-MM-DD"},null,8,["modelValue"])]),_:1},512)]),_:1},8,["modelValue","error"])]),s("div",pt,[s("div",{class:X(["text-caption text-uppercase",p.dateend.type?"text-negative text-italic":"text-grey"])},m(p.dateend.type?p.dateend.msg:"date end"),3),a(ee,{outlined:"",modelValue:k.value,"onUpdate:modelValue":r[8]||(r[8]=d=>k.value=d),label:"Enter Date",error:p.dateend.type,"no-error-icon":""},{default:l(()=>[a(ke,{cover:"","transition-show":"scale","transition-hide":"scale",class:"no-shadow custom-border radius-sm",ref_key:"popup",ref:ce},{default:l(()=>[a($e,{modelValue:k.value,"onUpdate:modelValue":[r[6]||(r[6]=d=>k.value=d),r[7]||(r[7]=()=>{ce.value.hide()})],mask:"YYYY-MM-DD"},null,8,["modelValue"])]),_:1},512)]),_:1},8,["modelValue","error"])]),s("div",vt,[r[20]||(r[20]=s("div",{class:"text-caption text-uppercase text-grey"},"day/s",-1)),a(ee,{modelValue:Y.value,"onUpdate:modelValue":r[9]||(r[9]=d=>Y.value=d),outlined:"","no-error-icon":!0,readonly:!0},null,8,["modelValue"])])])])):h("",!0)]))]),_:1})]),_:1}),a(ne,{class:"q-pa-lg bg"},{default:l(()=>[s("div",mt,[P.value>0?(c(),M(V,{key:0,unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"previous",onClick:r[10]||(r[10]=()=>{Ae()})})):h("",!0),P.value<Ve-1?(c(),M(V,{key:1,unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"next",onClick:r[11]||(r[11]=()=>{Ye()})})):h("",!0),P.value===Ve-1?(c(),M(V,{key:2,unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"save",onClick:u})):h("",!0),a(V,{unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"discard",onClick:r[12]||(r[12]=()=>{R("update:modelValue",null)}),outline:""}),P.value===0?(c(),M(ee,{key:3,outlined:"",dense:"",debounce:"1000",modelValue:G.value,"onUpdate:modelValue":r[13]||(r[13]=d=>G.value=d),placeholder:"Search..."},{prepend:l(()=>[a(ge,{name:"bi-search",style:{"font-size":"1rem"}})]),after:l(()=>[s("div",xt,m(Ce.value)+" of "+m(Le.value),1)]),_:1},8,["modelValue"])):h("",!0)])]),_:1}),a(ze,{showing:W.value},{default:l(()=>[a(S,{class:"no-shadow radius-md q-pa-md"},{default:l(()=>[a(w,{class:"text-center"},{default:l(()=>[s("div",null,[a(me,{color:"dark"})]),r[22]||(r[22]=s("div",{class:"text-dark text-uppercase text-caption"},"we're working on it!",-1))]),_:1,__:[22]})]),_:1})]),_:1},8,["showing"])]),_:1})]),_:1},8,["modelValue"]))}},gt=Ie(ft,[["__scopeId","data-v-8876b1d7"]]),yt={class:"q-mb-md"},_t={class:"text-body1 text-uppercase"},ht={class:"q-mb-md"},bt={class:"text-body1 text-uppercase"},wt={class:"q-mb-md"},$t={class:"text-body1 text-uppercase"},kt={class:"q-mb-md"},Vt={class:"text-body1 text-uppercase"},St={class:"q-mb-md"},Dt={class:"text-body1 text-uppercase"},qt={class:"row q-col-gutter-xl q-mb-md q-mt-xl"},zt={class:"text-caption text-uppercase text-grey"},Ct={key:0},Lt={class:"text-h6 text-uppercase"},Et={class:"text-body1 text-uppercase text-italic"},Yt={key:1},At={key:0},Pt={class:"text-grey q-mb-lg"},Mt={class:"text-h6 text-uppercase"},Ut={class:"text-body1 text-uppercase text-italic"},Rt=["src"],Tt={class:"text-h6 text-uppercase"},Ft={class:"text-body1 text-uppercase text-italic"},Nt={class:"text-caption text-uppercase text-italic"},Qt={key:1},jt=["src"],Ot={class:"text-h6 text-uppercase"},Bt={class:"text-body1 text-uppercase text-italic"},It={class:"text-caption text-uppercase text-italic"},Ht={key:2,class:"q-mt-md"},Wt={class:"q-gutter-sm"},Gt={class:"iframe-container"},Kt=["src"],Xt={__name:"LeaveInfoDialog",props:{modelValue:String,dialogName:String},emits:["update:modelValue","saved"],setup(de,{emit:oe}){const E=be(),U=qe(),R=de,C=oe,W=H({get:()=>R.modelValue===R.dialogName,set:o=>{o||C("update:modelValue",null)}}),$=f(!1),I=()=>{p(E.data?.id)},b=o=>{const t=Array.isArray(o)?o:o?.errors||[];Object.keys(Errors).forEach(i=>{Errors[i].type=null,Errors[i].messages=[]}),t.forEach(i=>{Errors[i.path]!==void 0&&(Errors[i.path].type=!0,Errors[i.path].messages.push(i.msg))})},g=o=>o?he(o).format("MMMM Do, YYYY hh:mm A"):"",L=o=>{if(!o)return"";const t=o.first_name||"",i=o.middle_name?o.middle_name.charAt(0).toUpperCase()+".":"",v=o.last_name||"",y=o.suffix?` ${o.suffix}`:"";return`${t} ${i} ${v}${y}`.trim()},k=(o,t,i="en-US")=>{if(!o)return"";const v=new Date(o),y=new Date(t||o),q=v.getFullYear()===y.getFullYear()&&v.getMonth()===y.getMonth()&&v.getDate()===y.getDate(),Q=K=>K.toLocaleString(i,{month:"long"}),A=K=>K.getDate(),G=K=>K.getFullYear();return q?`${Q(v)} ${A(v)}, ${G(v)}`:v.getMonth()===y.getMonth()&&v.getFullYear()===y.getFullYear()?`${Q(v)} ${A(v)}-${A(y)}, ${G(v)}`:`${Q(v)} ${A(v)}, ${G(v)} - ${Q(y)} ${A(y)}, ${G(y)}`},Y=(o,t)=>{if(!o)return 0;const i=new Date(o),v=new Date(t||o);i.setHours(0,0,0,0),v.setHours(0,0,0,0);const y=Math.round((v-i)/(1e3*60*60*24));return y>=0?y+1:0},T=o=>`https://hris-ccmi.com${o.signature}`,D=f(null),p=async o=>{$.value=!0;try{const t=await B.get(`/leave/${o}`);D.value=t.data.result}catch(t){console.error("Error fetching all data:",t),j.fire({icon:"error",html:`
                <div class="text-h6 text-bold text-uppercase">Error</div>
                <div class="text-caption text-capitalize;">Unable to fetch records</div>
            `})}finally{$.value=!1}},Z=H(()=>{if(!D.value?.approvals||D.value.approvals.length===0)return!1;const t=[...D.value.approvals].sort((i,v)=>i.order-v.order).find(i=>i.status==="Pending");return t?t.approver_id===U.user?.id:!1}),te=async o=>{$.value=!0;const t=Number(U.user.id),y=D.value.approvals.find(q=>Number(q?.approver_id)===Number(t))?.id??null;try{const q=await B.post(`/socket/leave/${o}/approve`,{approvalid:y});C("saved"),C("update:modelValue",null),j.fire({icon:"success",html:`
                <div class="text-h6 text-bold text-uppercase">granted!</div>
                <div class="text-caption text-capitalize;">${q.data.message}<div>
            `})}catch(q){q.response&&q.response.data&&(b(q.response.data),j.fire({icon:"error",html:`
                    <div class="text-h6 text-bold text-uppercase">Request Failed</div>
                    <div class="text-caption">Something went wrong.</div>
                `}))}finally{$.value=!1}},ae=async o=>{$.value=!0;try{const t=await B.post(`/socket/leave/${o}/cancel`);C("saved"),C("update:modelValue",null),j.fire({icon:"success",html:`
                <div class="text-h6 text-bold text-uppercase">granted!</div>
                <div class="text-caption text-capitalize;">${t.data.message}<div>
            `})}catch(t){t.response&&t.response.data&&(b(t.response.data),j.fire({icon:"error",html:`
                    <div class="text-h6 text-bold text-uppercase">Request Failed</div>
                    <div class="text-caption">Something went wrong.</div>
                `}))}finally{$.value=!1}},F=f(!1),N=f(null),se=async o=>{$.value=!0;try{const t=await B.get(`/leave/${o}/pdf`,{responseType:"arraybuffer"}),i=new Blob([t.data],{type:"application/pdf"}),v=window.URL.createObjectURL(i)+"#view=FitW";N.value=v,F.value=!0}catch(t){console.error("Error generating PDF:",t)}finally{$.value=!1}},O=f([]),x=H(()=>Array.isArray(O.value)&&O.value.some(o=>String(o).trim()!=="")),u=async o=>{$.value=!0;try{const t=await B.post(`/socket/leave/${o}/overide`,{signatories:O.value});j.fire({icon:"success",html:`
                <div class="text-h6 text-bold text-uppercase">granted!</div>
                <div class="text-caption text-capitalize;">${t.data.message}<div>
            `}),C("saved"),C("update:modelValue",null)}catch{e.response&&e.response.data&&(b(e.response.data),j.fire({icon:"error",html:`
                    <div class="text-h6 text-bold text-uppercase">Request Failed</div>
                    <div class="text-caption">Something went wrong.</div>
                `}))}finally{$.value=!1}};return(o,t)=>(c(),_(le,null,[a(ye,{modelValue:W.value,"onUpdate:modelValue":t[6]||(t[6]=i=>W.value=i),"full-height":"",position:"right",persistent:"",square:"",class:"dialog",onBeforeShow:t[7]||(t[7]=i=>I())},{default:l(()=>[a(S,{class:"dialog-card column full-height"},{default:l(()=>[a(w,{class:"q-pa-lg"},{default:l(()=>t[9]||(t[9]=[s("div",{class:"text-h6 text-uppercase"},"leave application",-1)])),_:1,__:[9]}),a(Se,{inset:""}),a(w,{class:"col q-pa-lg scroll"},{default:l(()=>[s("div",yt,[t[10]||(t[10]=s("div",{class:"text-caption text-uppercase text-grey"},"employee",-1)),s("div",_t,m(L(D.value?.employee)),1)]),s("div",ht,[t[11]||(t[11]=s("div",{class:"text-caption text-uppercase text-grey"},"leave type",-1)),s("div",bt,m(D.value?.leaveType?.name),1)]),s("div",wt,[t[12]||(t[12]=s("div",{class:"text-caption text-uppercase text-grey"},"leave duration",-1)),s("div",$t,m(k(D.value?.date_from,D.value?.date_to)),1)]),s("div",kt,[t[13]||(t[13]=s("div",{class:"text-caption text-uppercase text-grey"},"no of day",-1)),s("div",Vt,m(Y(D.value?.date_from,D.value?.date_to)),1)]),s("div",St,[t[14]||(t[14]=s("div",{class:"text-caption text-uppercase text-grey"},"status",-1)),s("div",Dt,m(D.value?.status),1)]),s("div",qt,[(c(!0),_(le,null,re(D.value?.approvals,(i,v)=>(c(),_("div",null,[s("div",zt,m(i?.status=="Pending"?"unsigned":i?.setting?.description),1),i?.status=="Pending"?(c(),_("div",Ct,[s("div",Lt,m(i?.original_approver_name),1),s("div",Et,m(i?.original_approver_position),1)])):h("",!0),i?.status=="Approved"?(c(),_("div",Yt,[i?.is_overide?(c(),_("div",At,[s("div",Pt,[s("div",Mt,m(i?.original_approver_name),1),s("div",Ut,m(i?.original_approver_position),1)]),t[15]||(t[15]=s("div",{class:"text-caption text-uppercase text-italic text-bold q-mb-lg"},"overiden by",-1)),s("img",{src:T(i?.override_signature),width:"150"},null,8,Rt),s("div",Tt,m(i?.override_name),1),s("div",Ft,m(i?.override_position),1),s("div",Nt,m(g(i?.signed_at)),1)])):h("",!0),i?.is_overide?h("",!0):(c(),_("div",Qt,[s("img",{src:T(i?.original_signature),width:"150"},null,8,jt),s("div",Ot,m(i?.original_approver_name),1),s("div",Bt,m(i?.original_approver_position),1),s("div",It,m(g(i?.signed_at)),1)]))])):h("",!0),i?.status=="Pending"&&z(U).hasRole(["SuperAdmin","Management"])&&z(E).data?.status!=="Cancelled"?(c(),_("div",Ht,[a(Ue,{modelValue:O.value,"onUpdate:modelValue":t[0]||(t[0]=y=>O.value=y),val:i?.id,label:"Overide","checked-icon":"bi-check-circle-fill","unchecked-icon":"bi-check-circle",size:"sm",class:"tex-caption"},null,8,["modelValue","val"])])):h("",!0)]))),256))])]),_:1}),a(ne,{class:"q-pa-lg bg"},{default:l(()=>[s("div",Wt,[Z.value&&z(U).hasRole(["SuperAdmin","Admin","Management","HR"])?(c(),M(V,{key:0,unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"approve"},{default:l(()=>[a(xe,{onBeforeShow:()=>{},"transition-show":"jump-up","transition-hide":"jump-down",offset:[0,15],class:"radius-sm",style:{"box-shadow":"rgba(0, 0, 0, 0.09) 0px 3px 12px"}},{default:l(()=>[a(S,{class:"no-shadow radius-sm q-pa-lg",style:{width:"300px"}},{default:l(()=>[a(w,null,{default:l(()=>t[16]||(t[16]=[s("div",{class:"text-h6 text-center text-uppercase"}," proceed to approve ",-1)])),_:1,__:[16]}),a(ne,null,{default:l(()=>[a(V,{unelevated:"",size:"md",color:"primary",class:"full-width text-capitalize",label:"proceed",onClick:t[1]||(t[1]=i=>te(z(E).data?.id))})]),_:1})]),_:1})]),_:1})]),_:1})):h("",!0),z(E).data?.status=="Filed"&&z(U).hasRole(["SuperAdmin","Management"])?(c(),M(V,{key:1,disable:!x.value,unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"overide"},{default:l(()=>[a(xe,{onBeforeShow:()=>{},"transition-show":"jump-up","transition-hide":"jump-down",offset:[0,15],class:"radius-sm",style:{"box-shadow":"rgba(0, 0, 0, 0.09) 0px 3px 12px"}},{default:l(()=>[a(S,{class:"no-shadow radius-sm q-pa-lg",style:{width:"300px"}},{default:l(()=>[a(w,null,{default:l(()=>t[17]||(t[17]=[s("div",{class:"text-h6 text-center text-uppercase"}," proceed to overide signature ",-1)])),_:1,__:[17]}),a(ne,null,{default:l(()=>[a(V,{unelevated:"",size:"md",color:"primary",class:"full-width text-capitalize",label:"proceed",onClick:t[2]||(t[2]=i=>u(z(E).data?.id))})]),_:1})]),_:1})]),_:1})]),_:1},8,["disable"])):h("",!0),z(E).data?.status!=="Cancelled"&&z(U).hasRole(["SuperAdmin","Admin","Management","HR"])?(c(),M(V,{key:2,unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"cancel"},{default:l(()=>[a(xe,{"transition-show":"jump-up","transition-hide":"jump-down",offset:[0,15],class:"radius-sm",style:{"box-shadow":"rgba(0, 0, 0, 0.09) 0px 3px 12px"}},{default:l(()=>[a(S,{class:"no-shadow radius-sm q-pa-lg",style:{width:"300px"}},{default:l(()=>[a(w,null,{default:l(()=>t[18]||(t[18]=[s("div",{class:"text-h6 text-center text-uppercase"}," proceed to cancel ",-1)])),_:1,__:[18]}),a(ne,null,{default:l(()=>[a(V,{unelevated:"",size:"md",color:"primary",class:"full-width text-capitalize",label:"proceed",onClick:t[3]||(t[3]=i=>ae(z(E).data?.id))})]),_:1})]),_:1})]),_:1})]),_:1})):h("",!0),z(E).data?.status!=="Cancelled"?(c(),M(V,{key:3,unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"print",onClick:t[4]||(t[4]=i=>se(z(E).data?.id))})):h("",!0),a(V,{unelevated:"",size:"md",color:"primary",class:"btn text-capitalize",label:"discard",onClick:t[5]||(t[5]=()=>{C("update:modelValue",null)}),outline:""})])]),_:1}),a(ze,{showing:$.value},{default:l(()=>[a(S,{class:"no-shadow radius-md q-pa-md"},{default:l(()=>[a(w,{class:"text-center"},{default:l(()=>[s("div",null,[a(me,{color:"dark"})]),t[19]||(t[19]=s("div",{class:"text-dark text-uppercase text-caption"},"we're working on it!",-1))]),_:1,__:[19]})]),_:1})]),_:1},8,["showing"])]),_:1})]),_:1},8,["modelValue"]),a(ye,{modelValue:F.value,"onUpdate:modelValue":t[8]||(t[8]=i=>F.value=i),"full-height":"","full-width":"",class:"pdf"},{default:l(()=>[a(S,{class:"bg-white q-pa-none",style:{height:"100vh",overflow:"hidden"}},{default:l(()=>[_e(a(V,{icon:"bi-x",class:"fixed bg-white text-primary shadow-2",round:"",dense:"",style:{top:"15px",right:"15px","z-index":"999"}},null,512),[[He]]),a(w,{class:"q-pa-none",style:{height:"100%",overflow:"hidden"}},{default:l(()=>[s("div",Gt,[N.value?(c(),_("iframe",{key:0,src:N.value,frameborder:"0"},null,8,Kt)):h("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},Zt={class:"filter-inline"},Jt={class:"q-gutter-xs"},ea={class:"card-grid"},ta={key:0,class:"card-anim-wrapper",style:{animationDelay:"120ms"}},aa={key:1,class:"card-anim-wrapper",style:{animationDelay:"120ms"}},sa={key:2,class:"card-anim-wrapper",style:{animationDelay:"120ms"}},la={class:"text-subtitle2 text-uppercase"},oa={class:"text-caption text-capitalize text-grey"},ia={class:"text-caption text-uppercase"},na={class:"text-caption"},ra={class:"text-caption text-grey"},da={class:"text-caption text-uppercase"},ua={id:"glass-overlay"},_a={__name:"LeavePage",setup(de){const oe=qe(),E=be(),U=new Date,R=f(String(U.getMonth()+1).padStart(2,"0")),C=f(String(U.getFullYear())),W=Array.from({length:12},(x,u)=>{const o=new Date(0,u).toLocaleString("en-US",{month:"short"}),t=String(u+1).padStart(2,"0");return{label:o,value:t}}),$=f(!1),I=f([]),b=f({}),g=f(1),L=f(10),k=f(""),Y=async()=>{$.value=!0;try{const{data:x}=await B.get("/leave",{params:{Page:g.value,Limit:L.value,Filter:k.value||"",month:R.value,year:C.value}});I.value=x.data,b.value=x.meta}catch(x){console.error("Error fetching all data:",x),j.fire({icon:"error",html:`
                <div class="text-h6 text-bold text-uppercase">Error</div>
                <div class="text-caption text-capitalize;">Unable to fetch records</div>
            `})}finally{$.value=!1}};Re(k,()=>{g.value=1,Y()});const T=()=>{g.value<b.value.TotalPages&&(g.value++,Y())},D=()=>{g.value>1&&(g.value--,Y())},p=()=>{g.value>1&&(g.value=1,Y())},Z=()=>{g.value<b.value.TotalPages&&(g.value=b.value.TotalPages,Y())},te=x=>{if(!x)return"";const u=x.first_name||"",o=x.middle_name?x.middle_name.charAt(0).toUpperCase()+".":"",t=x.last_name||"",i=x.suffix?` ${x.suffix}`:"";return`${u} ${o} ${t}${i}`.trim()},ae=(x,u,o="en-US")=>{if(!x)return"";const t=new Date(x),i=new Date(u||x),v=t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate(),y=A=>A.toLocaleString(o,{month:"long"}),q=A=>A.getDate(),Q=A=>A.getFullYear();return v?`${y(t)} ${q(t)}, ${Q(t)}`:t.getMonth()===i.getMonth()&&t.getFullYear()===i.getFullYear()?`${y(t)} ${q(t)}-${q(i)}, ${Q(t)}`:`${y(t)} ${q(t)}, ${Q(t)} - ${y(i)} ${q(i)}, ${Q(i)}`},F=(x,u)=>{if(!x)return 0;const o=new Date(x),t=new Date(u||x);o.setHours(0,0,0,0),t.setHours(0,0,0,0);const i=Math.round((t-o)/(1e3*60*60*24));return i>=0?i+1:0};Te(()=>{Y()});const N=f(null),se=x=>{N.value=x},O=f(!0);return Fe(()=>{setTimeout(()=>{O.value=!1},1e3)}),(x,u)=>(c(),_("div",null,[a(S,{class:"no-shadow radius-xs q-mb-md"},{default:l(()=>[a(w,null,{default:l(()=>[s("div",Zt,[a(ee,{outlined:"",modelValue:C.value,"onUpdate:modelValue":u[0]||(u[0]=o=>C.value=o),style:{width:"80px"},dense:""},null,8,["modelValue"]),s("div",Jt,[(c(!0),_(le,null,re(z(W),(o,t)=>(c(),M(V,{round:"",unelevated:"",class:X(R.value===o.value?"active":"inactive"),onClick:()=>{R.value=o.value,Y()},size:"md",label:o.label},null,8,["class","onClick","label"]))),256))])])]),_:1})]),_:1}),s("div",ea,[z(oe).hasRole(["SuperAdmin","Admin","HR"])?(c(),_("div",ta,[_e((c(),M(S,{key:"data-add",class:"card card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm",onClick:u[1]||(u[1]=()=>{se("LeaveDialog"),z(E).isEdit=!1})},{default:l(()=>[a(w,null,{default:l(()=>[a(ge,{name:"bi-plus-circle",color:"grey",size:"xl"})]),_:1})]),_:1})),[[Qe]])])):h("",!0),$.value?(c(),_("div",aa,[a(S,{key:"data-add",class:"card card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm"},{default:l(()=>[a(w,{class:"text-center"},{default:l(()=>[a(me,{color:"dark"}),u[7]||(u[7]=s("div",{class:"text-caption text-grey text-uppercase q-mt-xs"},"we're working on it!",-1))]),_:1,__:[7]})]),_:1})])):!$.value&&I.value.length===0?(c(),_("div",sa,[a(S,{key:"data-add",class:"card card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm"},{default:l(()=>[a(w,{class:"text-center"},{default:l(()=>u[8]||(u[8]=[s("div",{class:"text-caption text-uppercase text-grey"},"no data found",-1)])),_:1,__:[8]})]),_:1})])):(c(!0),_(le,{key:3},re(I.value,(o,t)=>(c(),_("div",{key:`data-${o.id}`,class:"card-anim-wrapper",style:fe({animationDelay:`${t*120}ms`})},[a(S,{onClick:()=>{se("LeaveInfoDialog"),z(E).data=o},class:"card card-hover-animate flex column justify-center items-center no-shadow cursor-pointer radius-sm"},{default:l(()=>[a(w,null,{default:l(()=>[s("div",la,m(te(o?.employee)),1),s("div",oa,m(o?.status),1)]),_:2},1024),a(w,null,{default:l(()=>[s("div",ia,m(o?.leaveType?.name),1),s("div",na,m(ae(o?.date_from,o?.date_to)),1),s("div",ra,m(F(o?.date_from,o?.date_to))+" day/s",1)]),_:2},1024)]),_:2},1032,["onClick"])],4))),128))]),a(Be,{class:"bg-white no-shadow q-mx-lg q-mb-md q-py-sm radius-xs text-grey"},{default:l(()=>[a(je,null,{default:l(()=>[a(Oe,{class:"text-caption text-uppercase"},{default:l(()=>u[9]||(u[9]=[s("div",null,"Â© 2025 WORKFORCE. All Rights Reserved.",-1)])),_:1,__:[9]}),a(ee,{outlined:"",dense:"",debounce:"1000",modelValue:k.value,"onUpdate:modelValue":u[2]||(u[2]=o=>k.value=o),placeholder:"Search..."},{before:l(()=>[s("div",da,m(`page ${b.value.CurrentPage} of ${b.value.TotalPages}`),1)]),after:l(()=>[a(V,{unelevated:"",size:"sm",round:"",color:"primary",icon:"bi-arrow-bar-left",disable:g.value<=1,onClick:p},{default:l(()=>[a(ve,{anchor:"top middle",self:"top middle","transition-show":"scale","transition-hide":"scale",class:"text-capitalize"},{default:l(()=>u[10]||(u[10]=[pe("First Page")])),_:1,__:[10]})]),_:1},8,["disable"]),a(V,{unelevated:"",size:"sm",round:"",color:"primary",icon:"bi-arrow-left-short",disable:g.value<=1,onClick:D},{default:l(()=>[a(ve,{anchor:"top middle",self:"top middle","transition-show":"scale","transition-hide":"scale",class:"text-capitalize"},{default:l(()=>u[11]||(u[11]=[pe("Previous")])),_:1,__:[11]})]),_:1},8,["disable"]),a(V,{unelevated:"",size:"sm",round:"",color:"primary",icon:"bi-arrow-right-short",disable:g.value>=b.value.TotalPages,onClick:T},{default:l(()=>[a(ve,{anchor:"top middle",self:"top middle","transition-show":"scale","transition-hide":"scale",class:"text-capitalize"},{default:l(()=>u[12]||(u[12]=[pe("Next")])),_:1,__:[12]})]),_:1},8,["disable"]),a(V,{unelevated:"",size:"sm",round:"",color:"primary",icon:"bi-arrow-bar-right",disable:g.value>=b.value.TotalPages,onClick:Z},{default:l(()=>[a(ve,{anchor:"top middle",self:"top middle","transition-show":"scale","transition-hide":"scale",class:"text-capitalize"},{default:l(()=>u[13]||(u[13]=[pe("Last Page")])),_:1,__:[13]})]),_:1},8,["disable"])]),prepend:l(()=>[a(ge,{name:"bi-search",style:{"font-size":"1rem"}})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(gt,{modelValue:N.value,"onUpdate:modelValue":u[3]||(u[3]=o=>N.value=o),"dialog-name":"LeaveDialog",onSaved:u[4]||(u[4]=()=>{Y()})},null,8,["modelValue"]),a(Xt,{modelValue:N.value,"onUpdate:modelValue":u[5]||(u[5]=o=>N.value=o),"dialog-name":"LeaveInfoDialog",onSaved:u[6]||(u[6]=()=>{Y()})},null,8,["modelValue"]),a(De,{name:"glass-fade"},{default:l(()=>[_e(s("div",ua,[a(S,{class:"no-shadow radius-md q-pa-md"},{default:l(()=>[a(w,{class:"text-center"},{default:l(()=>[s("div",null,[a(me,{color:"dark"})]),u[14]||(u[14]=s("div",{class:"text-dark text-uppercase text-caption"},"we're working on it!",-1))]),_:1,__:[14]})]),_:1})],512),[[Ne,O.value]])]),_:1})]))}};export{_a as default};
