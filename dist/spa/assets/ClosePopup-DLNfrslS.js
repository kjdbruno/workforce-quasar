import{c as P,g as x,r as l,a as f,w,b8 as _,b as k,ac as C,bv as Q,bh as q,by as E,bz as K}from"./index-BTd0P64i.js";import{f as L,c as M,Q as j}from"./_plugin-vue_export-helper-gj2NyO7T.js";const N=P({name:"QPopupProxy",props:{...L,breakpoint:{type:[String,Number],default:450}},emits:["show","hide"],setup(e,{slots:o,emit:n,attrs:r}){const{proxy:a}=x(),{$q:d}=a,p=l(!1),s=l(null),h=f(()=>parseInt(e.breakpoint,10)),{canShow:g}=M({showing:p});function c(){return d.screen.width<h.value||d.screen.height<h.value?"dialog":"menu"}const u=l(c()),m=f(()=>u.value==="menu"?{maxHeight:"99vh"}:{});w(()=>c(),t=>{p.value!==!0&&(u.value=t)});function y(t){p.value=!0,n("show",t)}function b(t){p.value=!1,u.value=c(),n("hide",t)}return Object.assign(a,{show(t){g(t)===!0&&s.value.show(t)},hide(t){s.value.hide(t)},toggle(t){s.value.toggle(t)}}),_(a,"currentComponent",()=>({type:u.value,ref:s.value})),()=>{const t={ref:s,...m.value,...r,onShow:y,onHide:b};let i;return u.value==="dialog"?i=C:(i=j,Object.assign(t,{target:e.target,contextMenu:e.contextMenu,noParentEvent:!0,separateClosePopup:!0})),k(i,t,o.default)}}});function v(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const o=parseInt(e,10);return isNaN(o)?0:o}const S=Q({name:"close-popup",beforeMount(e,{value:o}){const n={depth:v(o),handler(r){n.depth!==0&&setTimeout(()=>{const a=E(e);a!==void 0&&K(a,r,n.depth)})},handlerKey(r){q(r,13)===!0&&n.handler(r)}};e.__qclosepopup=n,e.addEventListener("click",n.handler),e.addEventListener("keyup",n.handlerKey)},updated(e,{value:o,oldValue:n}){o!==n&&(e.__qclosepopup.depth=v(o))},beforeUnmount(e){const o=e.__qclosepopup;e.removeEventListener("click",o.handler),e.removeEventListener("keyup",o.handlerKey),delete e.__qclosepopup}});export{S as C,N as Q};
